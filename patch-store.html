<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trezi Patches | EverythingLanka Market</title>
  <style>
    :root {
      --bg-top:#141e30;
      --bg-bottom:#243b55;
      --primary:#1e6091;
      --primary-hover:#0c3e72;
      --accent:#ffdd57;
      --text:#fff;
      --danger:#ff4d4d;
    }
    body {
      margin:0;
      font-family:system-ui, sans-serif;
      background:linear-gradient(to bottom,var(--bg-top),var(--bg-bottom));
      color:var(--text);
      line-height:1.5;
    }
    header {
      background:var(--primary);
      padding:1rem;
      text-align:center;
      font-size:1.3rem;
      font-weight:bold;
    }
    .banner {
      background:var(--accent);
      color:#000;
      text-align:center;
      padding:0.8rem;
      margin:1rem;
      border-radius:10px;
      font-weight:bold;
      font-size:0.95rem;
    }
    .grid {
      display:grid;
      grid-template-columns:1fr;
      gap:1rem;
      padding:1rem;
    }
    .card {
      background:rgba(255,255,255,0.05);
      padding:1rem;
      border-radius:12px;
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      position:relative;
    }
    .card img {
      max-width:100%;
      border-radius:8px;
      cursor:pointer;
      object-fit:cover;
    }
    .card h3 {
      margin:0.5rem 0;
      font-size:1rem;
      color:var(--accent);
    }
    .out-stock {
      position:absolute;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:rgba(0,0,0,0.7);
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:12px;
      font-weight:bold;
      color:var(--danger);
      font-size:1rem;
    }
    .controls {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:0.6rem;
      margin-top:0.5rem;
    }
    .controls button {
      width:2.2rem;
      height:2.2rem;
      border-radius:50%;
      font-size:1rem;
      padding:0;
    }
    button {
      background:var(--primary);
      color:#fff;
      border:none;
      padding:0.6rem 1rem;
      border-radius:8px;
      font-size:0.95rem;
      cursor:pointer;
    }
    button:hover {
      background:var(--primary-hover);
    }
    .cart-bar {
      position:sticky;
      bottom:0;
      width:100%;
      background:var(--primary);
      padding:0.8rem 1rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-weight:bold;
      font-size:0.95rem;
      z-index:900;
    }
    .cart-bar button {
      background:var(--accent);
      color:#000;
      font-weight:bold;
      padding:0.6rem 1rem;
      border-radius:8px;
      font-size:0.95rem;
    }
    form {
      padding:1rem;
      background:rgba(255,255,255,0.05);
      margin:1rem;
      border-radius:10px;
    }
    form h2 {
      color:var(--accent);
      margin-bottom:0.5rem;
    }
    input, textarea {
      width:100%;
      padding:0.75rem;
      margin:0.5rem 0;
      border-radius:8px;
      border:none;
      font-size:1rem;
    }
    textarea { resize:vertical; }
    /* Modal styles */
    .modal {
      display:none;
      position:fixed;
      top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.9);
      justify-content:center;
      align-items:center;
      flex-direction:column;
      z-index:1000;
      padding:1rem;
    }
    .modal img {
      max-width:100%;
      max-height:70vh;
      border-radius:10px;
      margin-bottom:1rem;
    }
    .modal-controls {
      display:flex;
      gap:0.5rem;
      flex-wrap:wrap;
      justify-content:center;
    }
    .modal button {
      background:var(--accent);
      color:#000;
      font-weight:bold;
      padding:0.5rem 1rem;
      border-radius:6px;
      flex:1;
    }
    /* Tablet & desktop */
    @media(min-width:600px){
      .grid { grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); }
    }
    @media(min-width:900px){
      header { font-size:1.5rem; }
      .grid { grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); }
    }
  </style>
</head>
<body>

<header>Welcome to Trezi Patches</header>

<div class="banner">
  Purchase 10 Patches for Rs.300 and save Rs.50
</div>

<div class="grid" id="productGrid"></div>

<div class="cart-bar">
  <span id="cartTotal">0 item(s) • Rs.0</span>
  <button id="checkoutScroll">Checkout</button>
</div>

<form id="orderForm" action="https://formspree.io/f/mzzjdvjk" method="POST">
  <h2>Checkout • Place your order</h2>
  <input type="text" name="name" placeholder="Your Name" required>
  <input type="tel" name="phone" placeholder="Phone Number" required>
  <textarea name="address" placeholder="Delivery Address" required></textarea>
  <input type="hidden" name="orderDetails" id="orderDetails">
  <input type="hidden" name="orderTotal" id="orderTotal">
  <button type="submit">Confirm Order</button>
</form>

<!-- Modal -->
<div class="modal" id="imgModal">
  <img id="modalImg" src="" alt="">
  <div class="modal-controls">
    <button id="prevImg">◀ Prev</button>
    <button id="nextImg">Next ▶</button>
    <button id="closeModal">✖ Close</button>
  </div>
</div>

<script>
const PRODUCTS = [
  {id:'p1', name:'Cute Cat', images:[
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patch%202.webp',
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patch1.webp'
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patches1.jpg'
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patches2.jpg'
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patches3.jpg'
  ], priceSingle:35, price10:300, inStock:true},
  {id:'p2', name:'Fruit Patch', images:[
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patch2%20stich.webp',
    'https://raw.githubusercontent.com/San-rdg/Everything-Lanka/refs/heads/main/patch3%20stich.webp'
  ], priceSingle:35, price10:300, inStock:false},
];

const grid=document.getElementById('productGrid');
const state={cart:{}, modal:{images:[], index:0}};

function formatRs(v){return 'Rs.'+v;}

function renderProducts(){
  grid.innerHTML='';
  PRODUCTS.forEach(p=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <img src="${p.images[0]}" alt="${p.name}" data-id="${p.id}" class="preview">
      <h3>${p.name}</h3>
      <p>${formatRs(p.priceSingle)} each</p>
      <div class="controls">
        <button data-id="${p.id}" data-act="dec">-</button>
        <span id="qty-${p.id}">0</span>
        <button data-id="${p.id}" data-act="inc">+</button>
      </div>
      <button data-id="${p.id}" data-act="add">Add to Cart</button>
    `;
    if(!p.inStock){
      const overlay=document.createElement('div');
      overlay.className='out-stock';
      overlay.textContent='Out of Stock';
      card.appendChild(overlay);
    }
    grid.appendChild(card);
  });
}

function updateCart(){
  let total=0,count=0;
  for(const k in state.cart){
    const it=state.cart[k];
    total+=it.unitPrice*it.qty;
    count+=it.qty;
  }
  document.getElementById('cartTotal').textContent=`${count} item(s) • ${formatRs(total)}`;
}

// --- Product grid actions ---
grid.addEventListener('click',e=>{
  const btn=e.target.closest('button');
  if(btn){
    const id=btn.dataset.id;
    const act=btn.dataset.act;
    const prod=PRODUCTS.find(x=>x.id===id);
    if(!prod || !prod.inStock) return;
    const qtySpan=document.getElementById('qty-'+id);
    let qty=parseInt(qtySpan.textContent);
    if(act==='inc') qty++;
    if(act==='dec'&&qty>0) qty--;
    qtySpan.textContent=qty;
    if(act==='add'&&qty>0){
      if(!state.cart[id]) state.cart[id]={name:prod.name,unitPrice:prod.priceSingle,qty:0};
      state.cart[id].qty+=qty;
      qtySpan.textContent=0;
      updateCart();
    }
  }
  if(e.target.classList.contains('preview')){
    const id=e.target.dataset.id;
    const prod=PRODUCTS.find(x=>x.id===id);
    state.modal.images=prod.images;
    state.modal.index=0;
    showModal();
  }
});

// --- Modal functions ---
const modal=document.getElementById('imgModal');
const modalImg=document.getElementById('modalImg');
document.getElementById('closeModal').onclick=()=>modal.style.display='none';
document.getElementById('prevImg').onclick=()=>{changeImg(-1)};
document.getElementById('nextImg').onclick=()=>{changeImg(1)};

function showModal(){
  modal.style.display='flex';
  modalImg.src=state.modal.images[state.modal.index];
}
function changeImg(step){
  state.modal.index=(state.modal.index+step+state.modal.images.length)%state.modal.images.length;
  showModal();
}

// --- Checkout ---
document.getElementById('checkoutScroll').addEventListener('click',()=>{
  document.getElementById('orderForm').scrollIntoView({behavior:'smooth'});
});
document.getElementById('orderForm').addEventListener('submit',e=>{
  const details=Object.values(state.cart).map(i=>`${i.name} x${i.qty} = ${formatRs(i.unitPrice*i.qty)}`).join('\n');
  const total=Object.values(state.cart).reduce((s,i)=>s+i.unitPrice*i.qty,0);
  document.getElementById('orderDetails').value=details;
  document.getElementById('orderTotal').value=total;
});

renderProducts();
updateCart();
</script>
</body>
</html>










