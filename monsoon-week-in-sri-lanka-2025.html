<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Weekly Weather in Sri Lanka — 7-Day Forecast & Travel Tips (Updated)</title>
  <meta name="description" content="7-day weather forecast for Sri Lanka: temperatures, rain chance, winds, and travel tips for each region. Interactive charts, downloadable data, and SEO-rich content updated daily.">
  <meta name="keywords" content="Sri Lanka weather, 7 day forecast, Colombo weather, Galle forecast, Nuwara Eliya, monsoon, travel weather Sri Lanka 2025">

  <!-- Open Graph / Social -->
  <meta property="og:title" content="Sri Lanka 7-Day Weather Forecast — Updated Daily">
  <meta property="og:description" content="Interactive 7-day forecast for Sri Lanka with temperature, precipitation and wind charts, travel tips and downloadable CSV of the forecast.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/images/weather-sri-lanka-7day.jpg">
  <meta property="og:url" content="https://yourwebsite.com/sri-lanka-7day-weather.html">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Styles (keeps layout similar to your AliExpress page) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#1E6091; /* your blue */
      --accent-dark:#0c3e72;
      --bg:#f9fbfd;
      --card:#ffffff;
      --muted:#666;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{font-family:'Poppins',sans-serif;margin:0;background:linear-gradient(180deg,#f7f9fc,#eef4fb);color:#111}
    header{background:var(--accent);color:#fff;padding:28px 6rem;border-bottom:4px solid rgba(0,0,0,0.05)}
    header h1{margin:0;font-size:28px}
    .container{max-width:1200px;margin:36px auto;padding:0 1.5rem}
    .hero{background:var(--card);border-radius:var(--radius);padding:28px;display:flex;gap:24px;align-items:center;box-shadow:0 6px 18px rgba(16,40,76,0.06)}
    .hero-left{flex:1}
    .hero-right{width:360px}
    .meta{color:var(--muted);margin-top:8px}
    .summary-stats{display:flex;gap:12px;margin-top:12px}
    .stat{background:#f5fbff;padding:12px;border-radius:8px;flex:1;text-align:center}
    .stat h3{margin:0;font-size:18px}
    .stat p{margin:4px 0 0;color:var(--muted)}

    .grid{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:28px}
    .card{background:var(--card);padding:18px;border-radius:10px;box-shadow:0 4px 14px rgba(16,40,76,0.04)}
    h2{margin:0 0 12px 0}
    .charts{display:grid;grid-template-columns:1fr;gap:18px}
    canvas{width:100%!important;height:240px!important}

    .regions{display:flex;gap:8px;flex-wrap:wrap}
    .region-btn{padding:8px 12px;background:#fff;border:1px solid #e5eef8;border-radius:8px;cursor:pointer}
    .region-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}

    .faq{margin-top:18px}
    details{margin-bottom:10px}

    footer{text-align:center;padding:24px;color:var(--muted);margin-top:28px}

    @media (max-width:980px){
      header{padding:20px}
      .grid{grid-template-columns:1fr}
      .hero-right{width:100%}
      h1, header h1{font-size:20px}
    }
  </style>

  <!-- Structured Data: Article + FAQ for SEO -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Article",
    "headline":"Sri Lanka 7-Day Weather Forecast — Updated Daily",
    "description":"Interactive 7-day forecast for Sri Lanka with temperature, precipitation and wind charts, travel tips and downloadable CSV.",
    "author":{"@type":"Organization","name":"Everything Lanka"},
    "publisher":{"@type":"Organization","name":"Everything Lanka","logo":{"@type":"ImageObject","url":"https://yourwebsite.com/images/logo.png"}},
    "mainEntityOfPage":{"@type":"WebPage","@id":"https://yourwebsite.com/sri-lanka-7day-weather.html"}
  }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <div class="container"><h1>Everything Lanka — 7-Day Weather</h1></div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-left">
        <h2>Weekly Weather Forecast — Sri Lanka</h2>
        <p class="meta">Interactive forecast for major regions: Colombo, Galle, Kandy, Nuwara Eliya, Trincomalee and more. Updated automatically every 6 hours.</p>

        <div class="summary-stats">
          <div class="stat"><h3 id="avg-temp">--°C</h3><p>Avg Temp (7d)</p></div>
          <div class="stat"><h3 id="max-rain">-- mm</h3><p>Max Daily Rain</p></div>
          <div class="stat"><h3 id="max-wind">-- km/h</h3><p>Peak Wind</p></div>
        </div>

        <div style="margin-top:12px">
          <div class="regions" id="regionList">
            <button class="region-btn active" data-lat="6.9271" data-lon="79.8612">Colombo</button>
            <button class="region-btn" data-lat="6.0535" data-lon="80.2210">Kandy</button>
            <button class="region-btn" data-lat="6.8941" data-lon="80.0329">Nuwara Eliya</button>
            <button class="region-btn" data-lat="6.0286" data-lon="80.2140">Galle</button>
            <button class="region-btn" data-lat="8.5865" data-lon="81.2152">Trincomalee</button>
          </div>
        </div>

      </div>

      <aside class="hero-right card">
        <h3>Quick Travel Tip</h3>
        <p id="quickTip">Check coastal conditions before planning a beach day — currents can change quickly during transition seasons.</p>
        <p style="margin-top:8px;font-size:13px;color:var(--muted)">Last updated: <span id="lastUpdated">--</span></p>
        <a id="downloadCsv" href="#" style="display:inline-block;margin-top:12px;background:var(--accent);color:#fff;padding:10px 12px;border-radius:8px;text-decoration:none">Download CSV</a>
      </aside>
    </section>

    <div class="grid">
      <section class="card">
        <h2>Temperature & Precipitation</h2>
        <div class="charts">
          <canvas id="tempChart"></canvas>
          <canvas id="rainChart"></canvas>
          <canvas id="windChart"></canvas>
        </div>

        <div class="faq">
          <h3>Forecast Summary</h3>
          <p id="forecastSummary">Loading forecast summary...</p>

          <h3 style="margin-top:14px">Regional Notes</h3>
          <ul id="regionalNotes">
            <li>Colombo: Typical coastal heat with occasional showers.</li>
            <li>Nuwara Eliya: Cooler nights — bring a jacket.</li>
          </ul>
        </div>
      </section>

      <aside class="card">
        <h3>Detailed Forecast</h3>
        <div id="dayList">Loading…</div>

        <hr style="margin:16px 0">
        <h3>FAQs</h3>
        <details>
          <summary>How often is this forecast updated?</summary>
          <p>Automatically every 6 hours from the source API. Manual refresh available.</p>
        </details>
        <details>
          <summary>Which data source do you use?</summary>
          <p>The page can fetch public forecasts from Open-Meteo or OpenWeatherMap. See notes in the footer.</p>
        </details>
      </aside>
    </div>

    <section class="card" style="margin-top:18px">
      <h2>How to Use This Page for Travel Planning</h2>
      <p>Pick your region, check the daily precipitation and wind charts, and download the CSV if you want to import into a route planner. Use the quick travel tips for packing and timing outdoor activities.</p>
    </section>

    <footer class="card" style="margin-top:18px">
      <p style="margin:0;color:var(--muted)">Data sources: Open-Meteo, local meteorological services. This forecast is indicative — always check official warnings for severe weather.</p>
    </footer>
  </main>

  <script>
  // ---------------------------
  // Helper: generate iso dates for next 7 days
  function getISODate(d){return d.toISOString().slice(0,10)}
  function next7Dates(){
    const arr=[];const today=new Date();
    for(let i=0;i<7;i++){const d=new Date(today);d.setDate(today.getDate()+i);arr.push(getISODate(d))}
    return arr;
  }

  // ---------------------------
  // Default: sample forecast data (used while loading or if API blocked)
  const sample = {
    dates: next7Dates(),
    temp_max: [31,31,30,29,28,30,31],
    temp_min: [24,24,23,22,21,22,23],
    rain: [0,5,12,0,30,0,2],
    wind_kmh: [18,20,22,12,10,14,16]
  };

  // Chart instances
  let tempChart, rainChart, windChart;

  function createCharts(data){
    const ctxT=document.getElementById('tempChart').getContext('2d');
    const ctxR=document.getElementById('rainChart').getContext('2d');
    const ctxW=document.getElementById('windChart').getContext('2d');

    if(tempChart) tempChart.destroy();
    if(rainChart) rainChart.destroy();
    if(windChart) windChart.destroy();

    tempChart=new Chart(ctxT,{
      type:'line',
      data:{labels:data.dates, datasets:[
        {label:'Max °C',data:data.temp_max,fill:false,tension:0.25,yAxisID:'y'},
        {label:'Min °C',data:data.temp_min,fill:false,tension:0.25,yAxisID:'y'}
      ]},
      options:{responsive:true,plugins:{legend:{position:'top'}}}
    });

    rainChart=new Chart(ctxR,{type:'bar',data:{labels:data.dates,datasets:[{label:'Precipitation (mm)',data:data.rain}]},options:{responsive:true,plugins:{legend:{display:false}}}});

    windChart=new Chart(ctxW,{type:'line',data:{labels:data.dates,datasets:[{label:'Wind (km/h)',data:data.wind_kmh,fill:true,tension:0.3}]},options:{responsive:true}});
  }

  // Render day list and stats
  function renderSummary(data){
    const avgTemp = (data.temp_max.reduce((a,b)=>a+b,0)/data.temp_max.length).toFixed(1);
    document.getElementById('avg-temp').textContent = avgTemp + '°C';
    document.getElementById('max-rain').textContent = Math.max(...data.rain) + ' mm';
    document.getElementById('max-wind').textContent = Math.max(...data.wind_kmh) + ' km/h';

    const dayList=document.getElementById('dayList'); dayList.innerHTML='';
    data.dates.forEach((d,i)=>{
      const el = document.createElement('div');
      el.style.padding='8px 0';
      el.innerHTML = `<strong>${d}</strong> — ${data.temp_min[i]}°C / ${data.temp_max[i]}°C • ${data.rain[i]} mm • ${data.wind_kmh[i]} km/h`;
      dayList.appendChild(el);
    });

    // summary paragraph
    const rainyDays = data.rain.filter(r=>r>5).length;
    document.getElementById('forecastSummary').textContent = `Over the next 7 days expect ${rainyDays} wetter day(s) with higher chances of showers. Temperatures stay warm on the coast and cooler in hill country.`;

    // CSV download
    const csvRows = ['date,temp_min,temp_max,precipitation,wind_kmh'];
    data.dates.forEach((d,i)=> csvRows.push([d,data.temp_min[i],data.temp_max[i],data.rain[i],data.wind_kmh[i]].join(',')));
    const csvString = csvRows.join('\n');
    const blob = new Blob([csvString],{type:'text/csv'});
    const url = URL.createObjectURL(blob);
    const dl = document.getElementById('downloadCsv');
    dl.href = url; dl.download = 'sri-lanka-7day-forecast.csv';

    document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
  }

  // ---------------------------
  // Fetch real data from Open-Meteo (no API key required). You can change lat/lon for different regions.
  async function fetchForecast(lat,lon){
    try{
      const dates = next7Dates();
      const start = dates[0];
      const end = dates[dates.length-1];
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,windspeed_10m_max&timezone=Asia%2FColombo&start_date=${start}&end_date=${end}`;
      const res = await fetch(url);
      if(!res.ok) throw new Error('Weather API error');
      const json = await res.json();
      return {
        dates: json.daily.time,
        temp_max: json.daily.temperature_2m_max.map(x=>Math.round(x)),
        temp_min: json.daily.temperature_2m_min.map(x=>Math.round(x)),
        rain: json.daily.precipitation_sum.map(x=>Math.round(x)),
        wind_kmh: json.daily.windspeed_10m_max.map(x=>Math.round(x))
      };
    }catch(err){
      console.warn('Falling back to sample data',err);
      return sample;
    }
  }

  // ---------------------------
  // Wire up region buttons
  document.getElementById('regionList').addEventListener('click',async function(e){
    const btn = e.target.closest('.region-btn');
    if(!btn) return;
    document.querySelectorAll('.region-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const lat = btn.dataset.lat; const lon = btn.dataset.lon;
    // fetch and render
    const data = await fetchForecast(lat,lon);
    createCharts(data);
    renderSummary(data);
  });

  // Initial load: use Colombo
  (async function(){
    const defaultBtn = document.querySelector('.region-btn.active');
    const lat = defaultBtn.dataset.lat; const lon = defaultBtn.dataset.lon;
    const data = await fetchForecast(lat,lon);
    createCharts(data);
    renderSummary(data);
  })();

  </script>
</body>
</html>
